(function(l,i,c,p,d){"use strict";function s(e){return e&&typeof e=="object"&&"default"in e?e:{default:e}}var u=s(c),r=s(p),g=()=>d.injectCSS(".sc--container>.player{border-bottom:1px solid var(--background-modifier-accent);padding:8px;display:flex;flex-direction:column;gap:8px}.sc--container>.player .big-artwork{width:224px;height:224px;background-position:center;background-size:cover;border-radius:4px;display:flex;align-items:flex-start;justify-content:flex-end}.sc--container>.player .big-artwork:hover .collapse{opacity:.25}.sc--container>.player .big-artwork .collapse{display:flex;padding:4px;background-color:#000;opacity:0;border-radius:50%;margin:4px;cursor:pointer}.sc--container>.player .big-artwork .collapse:hover{opacity:.75}.sc--container>.player .big-artwork .collapse svg{width:16px;height:16px;color:#f5f5f5}.sc--container>.player .small-artwork{width:64px;height:64px;min-width:64px;background-position:center;background-size:cover;border-radius:4px;display:flex;align-items:flex-start;justify-content:flex-end}.sc--container>.player .small-artwork:hover .expand{opacity:.25}.sc--container>.player .small-artwork .expand{display:flex;padding:4px;background-color:#000;opacity:0;border-radius:50%;margin:4px;cursor:pointer}.sc--container>.player .small-artwork .expand:hover{opacity:.75}.sc--container>.player .small-artwork .expand svg{width:14px;height:14px;color:#f5f5f5}.sc--container>.player>.info{display:flex;gap:8px;justify-content:center}.sc--container>.player>.info>.data{width:100%;display:flex;justify-content:center;flex-direction:column;gap:8px}.sc--container>.player>.info>.data>.texts .title{font-size:16px;color:#f5f5f5;font-weight:500;opacity:.95;width:152px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.sc--container>.player>.info>.data>.texts .artist{font-size:12px;color:#f5f5f5;font-weight:400;opacity:.75;width:152px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.sc--container>.player>.info>.data>.texts .expand{width:224px}.sc--container>.player>.info>.data>.controls{display:flex;justify-content:space-around}.sc--container>.player>.info>.data>.controls .button{display:flex;background-color:#0000001a;padding:4px;border-radius:4px;cursor:pointer}.sc--container>.player>.info>.data>.controls .button svg{width:16px;height:16px;color:#f5f5f5}.sc--container>.player>.info>.data>.controls .button:hover{background-color:#00000040}.sc--container>.player>.progress-container{display:flex;align-items:center;gap:8px}.sc--container>.player>.progress-container .text{font-size:12px;color:#f5f5f5;min-width:32px}.sc--container>.player>.progress-container>.progress{width:100%;overflow:hidden;height:12px;-webkit-appearance:none;background-color:#00000026;border-radius:9999px;cursor:pointer}.sc--container>.player>.progress-container>.progress::-webkit-slider-thumb{width:12px;height:12px;-webkit-appearance:none;background:whitesmoke;border-radius:50%;cursor:ew-resize}"),f={load(){l.subscriptions.push(g(),(()=>{const e=u.default.parse(`
            <div class="sc--container">
              <div v-if="track" class="player">
                <div v-if="track?.album?.image && bigArtwork" class="big-artwork" :style="\`background-image: url('\${track.album.image.url}')\`">
                  <div class="collapse" @click="bigArtwork = false">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                      <path fill="currentColor" d="M11.9997 13.1714L16.9495 8.22168L18.3637 9.63589L11.9997 15.9999L5.63574 9.63589L7.04996 8.22168L11.9997 13.1714Z"></path>
                    </svg>
                  </div>
                </div>
                <div class="info">
                  <div v-if="track?.album?.image && !bigArtwork" class="small-artwork" :style="\`background-image: url('\${track.album.image.url}')\`">
                    <div class="expand" @click="bigArtwork = true">
                      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                        <path fill="currentColor" d="M11.9997 10.8284L7.04996 15.7782L5.63574 14.364L11.9997 8L18.3637 14.364L16.9495 15.7782L11.9997 10.8284Z"></path>
                      </svg>
                    </div>
                  </div>
                  <div class="data">
                    <div class="texts">
                      <div class="title" :class="{'expand': bigArtwork}" :acord--tooltip-content="track.name">{{ track.name }}</div>
                      <div class="artist" :class="{'expand': bigArtwork}" :acord--tooltip-content="track.artists[0].name">{{ track.artists[0].name }}</div>
                    </div>
                    <div class="controls">
                      <div class="button" @click="skipPrevious">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                          <path fill="currentColor" d="M8 12L14 6V18L8 12Z"></path>
                        </svg>
                      </div>
                      <div class="button" @click="playPause">
                        <svg v-if="!isPlaying" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                          <path fill="currentColor" d="M19.376 12.4158L8.77735 19.4816C8.54759 19.6348 8.23715 19.5727 8.08397 19.3429C8.02922 19.2608 8 19.1643 8 19.0656V4.93408C8 4.65794 8.22386 4.43408 8.5 4.43408C8.59871 4.43408 8.69522 4.4633 8.77735 4.51806L19.376 11.5838C19.6057 11.737 19.6678 12.0474 19.5146 12.2772C19.478 12.3321 19.4309 12.3792 19.376 12.4158Z"></path>
                        </svg>
                        <svg v-else xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                          <path fill="currentColor" d="M6 5H8V19H6V5ZM16 5H18V19H16V5Z"></path>
                        </svg>
                      </div>
                      <div class="button" @click="skipNext">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                          <path fill="currentColor" d="M16 12L10 18V6L16 12Z"></path>
                        </svg>
                      </div>
                    </div>
                  </div>
                </div>
                <div class="progress-container">
                  <div class="text">{{formatSeconds(progress/1000)}}</div>
                  <input type="range" class="progress" :value="progress" :max="duration" @input="onProgressInput" />
                  <div class="text">{{formatSeconds(duration/1000)}}</div>
                </div>
              </div>
            </div>
          `);let a=null;const o=Vue.createApp({data(){return{bigArtwork:!1,track:null,checkInterval:null,isPlaying:!1,progress:0,duration:0}},methods:{async fetchData(){let t=await r.default.spotify.request("GET","/me/player");t.item.album.image=t.item.album.images[0],this.track=t.item,this.isPlaying=t.is_playing,this.progress=t.progress_ms,this.duration=t.item.duration_ms,this.updateInterval()},stateUpdate(t){this.track=t.track,this.isPlaying=t.isPlaying,this.progress=t.position,this.duration=t.track?.duration||0,this.updateInterval()},playPause(){this.isPlaying?(r.default.spotify.request("PUT","/me/player/pause"),this.isPlaying=!1):(r.default.spotify.request("PUT","/me/player/play"),this.isPlaying=!0)},skipNext(){r.default.spotify.request("POST","/me/player/next")},skipPrevious(){this.progress>6e3?r.default.spotify.request("PUT","/me/player/seek?position_ms=0"):r.default.spotify.request("POST","/me/player/previous")},onProgressInput(t){clearInterval(a.checkInterval),this.debouncedProgressUpdate(t)},debouncedProgressUpdate:_.debounce(t=>{r.default.spotify.request("PUT","/me/player/seek?position_ms="+t.target.value),a.updateInterval()},250),updateInterval(){clearInterval(this.checkInterval),this.checkInterval=setInterval(()=>{this.isPlaying&&(this.progress+=1e3)},1e3)},formatSeconds(t){isNaN(parseInt(t))&&(t=0),t=Math.floor(t);let n=Math.floor(t/60/60);return`${n>0?`${n.toString().padStart(2,"0")}:`:""}${Math.floor(t/60%60).toString().padStart(2,"0")}:${(t%60).toString().padStart(2,"0")}`}},mounted(){a=this,this.fetchData(),i.FluxDispatcher.subscribe("SPOTIFY_PLAYER_STATE",this.stateUpdate),this.updateInterval()},unmounted(){clearInterval(this.checkInterval),i.FluxDispatcher.unsubscribe("SPOTIFY_PLAYER_STATE",this.stateUpdate)}});return o.mount(e),document.querySelector("section.panels-3wFtMD > .wrapper-3Hk9OB").insertAdjacentElement("afterend",e),()=>{o.unmount(),e.remove()}})())}};return f})($acord.extension,$acord.modules.common,$acord.dom,$acord.utils,$acord.patcher);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic291cmNlLmpzIiwic291cmNlcyI6WyIuLi9zcmMvaW5kZXguanMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgc3Vic2NyaXB0aW9ucyB9IGZyb20gXCJAYWNvcmQvZXh0ZW5zaW9uXCI7XHJcbmltcG9ydCB7IEZsdXhEaXNwYXRjaGVyIH0gZnJvbSBcIkBhY29yZC9tb2R1bGVzL2NvbW1vblwiO1xyXG5pbXBvcnQgZG9tIGZyb20gXCJAYWNvcmQvZG9tXCI7XHJcbmltcG9ydCB1dGlscyBmcm9tIFwiQGFjb3JkL3V0aWxzXCI7XHJcbmltcG9ydCBwYXRjaFNDU1MgZnJvbSBcIi4vc3R5bGVzLnNjc3NcIjtcclxuXHJcbmV4cG9ydCBkZWZhdWx0IHtcclxuICBsb2FkKCkge1xyXG4gICAgc3Vic2NyaXB0aW9ucy5wdXNoKFxyXG4gICAgICBwYXRjaFNDU1MoKSxcclxuICAgICAgKCgpID0+IHtcclxuICAgICAgICBjb25zdCBhcHBFbG0gPSBkb20ucGFyc2UoXHJcbiAgICAgICAgICBgXHJcbiAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJzYy0tY29udGFpbmVyXCI+XHJcbiAgICAgICAgICAgICAgPGRpdiB2LWlmPVwidHJhY2tcIiBjbGFzcz1cInBsYXllclwiPlxyXG4gICAgICAgICAgICAgICAgPGRpdiB2LWlmPVwidHJhY2s/LmFsYnVtPy5pbWFnZSAmJiBiaWdBcnR3b3JrXCIgY2xhc3M9XCJiaWctYXJ0d29ya1wiIDpzdHlsZT1cIlxcYGJhY2tncm91bmQtaW1hZ2U6IHVybCgnXFwke3RyYWNrLmFsYnVtLmltYWdlLnVybH0nKVxcYFwiPlxyXG4gICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPVwiY29sbGFwc2VcIiBAY2xpY2s9XCJiaWdBcnR3b3JrID0gZmFsc2VcIj5cclxuICAgICAgICAgICAgICAgICAgICA8c3ZnIHhtbG5zPVwiaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmdcIiB2aWV3Qm94PVwiMCAwIDI0IDI0XCI+XHJcbiAgICAgICAgICAgICAgICAgICAgICA8cGF0aCBmaWxsPVwiY3VycmVudENvbG9yXCIgZD1cIk0xMS45OTk3IDEzLjE3MTRMMTYuOTQ5NSA4LjIyMTY4TDE4LjM2MzcgOS42MzU4OUwxMS45OTk3IDE1Ljk5OTlMNS42MzU3NCA5LjYzNTg5TDcuMDQ5OTYgOC4yMjE2OEwxMS45OTk3IDEzLjE3MTRaXCI+PC9wYXRoPlxyXG4gICAgICAgICAgICAgICAgICAgIDwvc3ZnPlxyXG4gICAgICAgICAgICAgICAgICA8L2Rpdj5cclxuICAgICAgICAgICAgICAgIDwvZGl2PlxyXG4gICAgICAgICAgICAgICAgPGRpdiBjbGFzcz1cImluZm9cIj5cclxuICAgICAgICAgICAgICAgICAgPGRpdiB2LWlmPVwidHJhY2s/LmFsYnVtPy5pbWFnZSAmJiAhYmlnQXJ0d29ya1wiIGNsYXNzPVwic21hbGwtYXJ0d29ya1wiIDpzdHlsZT1cIlxcYGJhY2tncm91bmQtaW1hZ2U6IHVybCgnXFwke3RyYWNrLmFsYnVtLmltYWdlLnVybH0nKVxcYFwiPlxyXG4gICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJleHBhbmRcIiBAY2xpY2s9XCJiaWdBcnR3b3JrID0gdHJ1ZVwiPlxyXG4gICAgICAgICAgICAgICAgICAgICAgPHN2ZyB4bWxucz1cImh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnXCIgdmlld0JveD1cIjAgMCAyNCAyNFwiPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICA8cGF0aCBmaWxsPVwiY3VycmVudENvbG9yXCIgZD1cIk0xMS45OTk3IDEwLjgyODRMNy4wNDk5NiAxNS43NzgyTDUuNjM1NzQgMTQuMzY0TDExLjk5OTcgOEwxOC4zNjM3IDE0LjM2NEwxNi45NDk1IDE1Ljc3ODJMMTEuOTk5NyAxMC44Mjg0WlwiPjwvcGF0aD5cclxuICAgICAgICAgICAgICAgICAgICAgIDwvc3ZnPlxyXG4gICAgICAgICAgICAgICAgICAgIDwvZGl2PlxyXG4gICAgICAgICAgICAgICAgICA8L2Rpdj5cclxuICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz1cImRhdGFcIj5cclxuICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPVwidGV4dHNcIj5cclxuICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJ0aXRsZVwiIDpjbGFzcz1cInsnZXhwYW5kJzogYmlnQXJ0d29ya31cIiA6YWNvcmQtLXRvb2x0aXAtY29udGVudD1cInRyYWNrLm5hbWVcIj57eyB0cmFjay5uYW1lIH19PC9kaXY+XHJcbiAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPVwiYXJ0aXN0XCIgOmNsYXNzPVwieydleHBhbmQnOiBiaWdBcnR3b3JrfVwiIDphY29yZC0tdG9vbHRpcC1jb250ZW50PVwidHJhY2suYXJ0aXN0c1swXS5uYW1lXCI+e3sgdHJhY2suYXJ0aXN0c1swXS5uYW1lIH19PC9kaXY+XHJcbiAgICAgICAgICAgICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz1cImNvbnRyb2xzXCI+XHJcbiAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPVwiYnV0dG9uXCIgQGNsaWNrPVwic2tpcFByZXZpb3VzXCI+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIDxzdmcgeG1sbnM9XCJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2Z1wiIHZpZXdCb3g9XCIwIDAgMjQgMjRcIj5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICA8cGF0aCBmaWxsPVwiY3VycmVudENvbG9yXCIgZD1cIk04IDEyTDE0IDZWMThMOCAxMlpcIj48L3BhdGg+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIDwvc3ZnPlxyXG4gICAgICAgICAgICAgICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPVwiYnV0dG9uXCIgQGNsaWNrPVwicGxheVBhdXNlXCI+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIDxzdmcgdi1pZj1cIiFpc1BsYXlpbmdcIiB4bWxucz1cImh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnXCIgdmlld0JveD1cIjAgMCAyNCAyNFwiPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgIDxwYXRoIGZpbGw9XCJjdXJyZW50Q29sb3JcIiBkPVwiTTE5LjM3NiAxMi40MTU4TDguNzc3MzUgMTkuNDgxNkM4LjU0NzU5IDE5LjYzNDggOC4yMzcxNSAxOS41NzI3IDguMDgzOTcgMTkuMzQyOUM4LjAyOTIyIDE5LjI2MDggOCAxOS4xNjQzIDggMTkuMDY1NlY0LjkzNDA4QzggNC42NTc5NCA4LjIyMzg2IDQuNDM0MDggOC41IDQuNDM0MDhDOC41OTg3MSA0LjQzNDA4IDguNjk1MjIgNC40NjMzIDguNzc3MzUgNC41MTgwNkwxOS4zNzYgMTEuNTgzOEMxOS42MDU3IDExLjczNyAxOS42Njc4IDEyLjA0NzQgMTkuNTE0NiAxMi4yNzcyQzE5LjQ3OCAxMi4zMzIxIDE5LjQzMDkgMTIuMzc5MiAxOS4zNzYgMTIuNDE1OFpcIj48L3BhdGg+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIDwvc3ZnPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICA8c3ZnIHYtZWxzZSB4bWxucz1cImh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnXCIgdmlld0JveD1cIjAgMCAyNCAyNFwiPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgIDxwYXRoIGZpbGw9XCJjdXJyZW50Q29sb3JcIiBkPVwiTTYgNUg4VjE5SDZWNVpNMTYgNUgxOFYxOUgxNlY1WlwiPjwvcGF0aD5cclxuICAgICAgICAgICAgICAgICAgICAgICAgPC9zdmc+XHJcbiAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cclxuICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJidXR0b25cIiBAY2xpY2s9XCJza2lwTmV4dFwiPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICA8c3ZnIHhtbG5zPVwiaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmdcIiB2aWV3Qm94PVwiMCAwIDI0IDI0XCI+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgPHBhdGggZmlsbD1cImN1cnJlbnRDb2xvclwiIGQ9XCJNMTYgMTJMMTAgMThWNkwxNiAxMlpcIj48L3BhdGg+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIDwvc3ZnPlxyXG4gICAgICAgICAgICAgICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgICAgICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgICAgICAgICAgIDwvZGl2PlxyXG4gICAgICAgICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPVwicHJvZ3Jlc3MtY29udGFpbmVyXCI+XHJcbiAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJ0ZXh0XCI+e3tmb3JtYXRTZWNvbmRzKHByb2dyZXNzLzEwMDApfX08L2Rpdj5cclxuICAgICAgICAgICAgICAgICAgPGlucHV0IHR5cGU9XCJyYW5nZVwiIGNsYXNzPVwicHJvZ3Jlc3NcIiA6dmFsdWU9XCJwcm9ncmVzc1wiIDptYXg9XCJkdXJhdGlvblwiIEBpbnB1dD1cIm9uUHJvZ3Jlc3NJbnB1dFwiIC8+XHJcbiAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJ0ZXh0XCI+e3tmb3JtYXRTZWNvbmRzKGR1cmF0aW9uLzEwMDApfX08L2Rpdj5cclxuICAgICAgICAgICAgICAgIDwvZGl2PlxyXG4gICAgICAgICAgICAgIDwvZGl2PlxyXG4gICAgICAgICAgICA8L2Rpdj5cclxuICAgICAgICAgIGAsXHJcbiAgICAgICAgKVxyXG5cclxuICAgICAgICBsZXQgaW50ZXJuYWxBcHAgPSBudWxsO1xyXG4gICAgICAgIGNvbnN0IGFwcCA9IFZ1ZS5jcmVhdGVBcHAoe1xyXG4gICAgICAgICAgZGF0YSgpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgICBiaWdBcnR3b3JrOiBmYWxzZSxcclxuICAgICAgICAgICAgICB0cmFjazogbnVsbCxcclxuICAgICAgICAgICAgICBjaGVja0ludGVydmFsOiBudWxsLFxyXG4gICAgICAgICAgICAgIGlzUGxheWluZzogZmFsc2UsXHJcbiAgICAgICAgICAgICAgcHJvZ3Jlc3M6IDAsXHJcbiAgICAgICAgICAgICAgZHVyYXRpb246IDBcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgfSxcclxuICAgICAgICAgIG1ldGhvZHM6IHtcclxuICAgICAgICAgICAgYXN5bmMgZmV0Y2hEYXRhKCkge1xyXG4gICAgICAgICAgICAgIGxldCBkYXRhID0gYXdhaXQgdXRpbHMuc3BvdGlmeS5yZXF1ZXN0KFwiR0VUXCIsIFwiL21lL3BsYXllclwiKTtcclxuICAgICAgICAgICAgICBkYXRhLml0ZW0uYWxidW0uaW1hZ2UgPSBkYXRhLml0ZW0uYWxidW0uaW1hZ2VzWzBdO1xyXG5cclxuICAgICAgICAgICAgICB0aGlzLnRyYWNrID0gZGF0YS5pdGVtO1xyXG4gICAgICAgICAgICAgIHRoaXMuaXNQbGF5aW5nID0gZGF0YS5pc19wbGF5aW5nO1xyXG4gICAgICAgICAgICAgIHRoaXMucHJvZ3Jlc3MgPSBkYXRhLnByb2dyZXNzX21zO1xyXG4gICAgICAgICAgICAgIHRoaXMuZHVyYXRpb24gPSBkYXRhLml0ZW0uZHVyYXRpb25fbXM7XHJcblxyXG4gICAgICAgICAgICAgIHRoaXMudXBkYXRlSW50ZXJ2YWwoKTtcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgc3RhdGVVcGRhdGUoZGF0YSkge1xyXG4gICAgICAgICAgICAgIHRoaXMudHJhY2sgPSBkYXRhLnRyYWNrO1xyXG4gICAgICAgICAgICAgIHRoaXMuaXNQbGF5aW5nID0gZGF0YS5pc1BsYXlpbmc7XHJcbiAgICAgICAgICAgICAgdGhpcy5wcm9ncmVzcyA9IGRhdGEucG9zaXRpb247XHJcbiAgICAgICAgICAgICAgdGhpcy5kdXJhdGlvbiA9IGRhdGEudHJhY2s/LmR1cmF0aW9uIHx8IDA7XHJcbiAgICAgICAgICAgICAgdGhpcy51cGRhdGVJbnRlcnZhbCgpO1xyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICBwbGF5UGF1c2UoKSB7XHJcbiAgICAgICAgICAgICAgaWYgKHRoaXMuaXNQbGF5aW5nKSB7XHJcbiAgICAgICAgICAgICAgICB1dGlscy5zcG90aWZ5LnJlcXVlc3QoXCJQVVRcIiwgXCIvbWUvcGxheWVyL3BhdXNlXCIpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5pc1BsYXlpbmcgPSBmYWxzZTtcclxuICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgdXRpbHMuc3BvdGlmeS5yZXF1ZXN0KFwiUFVUXCIsIFwiL21lL3BsYXllci9wbGF5XCIpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5pc1BsYXlpbmcgPSB0cnVlO1xyXG4gICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgc2tpcE5leHQoKSB7XHJcbiAgICAgICAgICAgICAgdXRpbHMuc3BvdGlmeS5yZXF1ZXN0KFwiUE9TVFwiLCBcIi9tZS9wbGF5ZXIvbmV4dFwiKTtcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgc2tpcFByZXZpb3VzKCkge1xyXG4gICAgICAgICAgICAgIGlmICh0aGlzLnByb2dyZXNzID4gNjAwMCkge1xyXG4gICAgICAgICAgICAgICAgdXRpbHMuc3BvdGlmeS5yZXF1ZXN0KFwiUFVUXCIsIFwiL21lL3BsYXllci9zZWVrP3Bvc2l0aW9uX21zPTBcIik7XHJcbiAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIHV0aWxzLnNwb3RpZnkucmVxdWVzdChcIlBPU1RcIiwgXCIvbWUvcGxheWVyL3ByZXZpb3VzXCIpO1xyXG4gICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgb25Qcm9ncmVzc0lucHV0KGUpIHtcclxuICAgICAgICAgICAgICBjbGVhckludGVydmFsKGludGVybmFsQXBwLmNoZWNrSW50ZXJ2YWwpO1xyXG4gICAgICAgICAgICAgIHRoaXMuZGVib3VuY2VkUHJvZ3Jlc3NVcGRhdGUoZSk7XHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIGRlYm91bmNlZFByb2dyZXNzVXBkYXRlOiBfLmRlYm91bmNlKChlKSA9PiB7XHJcbiAgICAgICAgICAgICAgdXRpbHMuc3BvdGlmeS5yZXF1ZXN0KFwiUFVUXCIsIFwiL21lL3BsYXllci9zZWVrP3Bvc2l0aW9uX21zPVwiICsgZS50YXJnZXQudmFsdWUpO1xyXG4gICAgICAgICAgICAgIGludGVybmFsQXBwLnVwZGF0ZUludGVydmFsKCk7XHJcbiAgICAgICAgICAgIH0sIDI1MCksXHJcbiAgICAgICAgICAgIHVwZGF0ZUludGVydmFsKCkge1xyXG4gICAgICAgICAgICAgIGNsZWFySW50ZXJ2YWwodGhpcy5jaGVja0ludGVydmFsKTtcclxuICAgICAgICAgICAgICB0aGlzLmNoZWNrSW50ZXJ2YWwgPSBzZXRJbnRlcnZhbCgoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5pc1BsYXlpbmcpIHRoaXMucHJvZ3Jlc3MgKz0gMTAwMDtcclxuICAgICAgICAgICAgICB9LCAxMDAwKTtcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgZm9ybWF0U2Vjb25kcyhzKSB7XHJcbiAgICAgICAgICAgICAgaWYgKGlzTmFOKHBhcnNlSW50KHMpKSkgcyA9IDA7XHJcbiAgICAgICAgICAgICAgcyA9IE1hdGguZmxvb3Iocyk7XHJcbiAgICAgICAgICAgICAgbGV0IGhvdXJzID0gTWF0aC5mbG9vcigocyAvIDYwKSAvIDYwKTtcclxuICAgICAgICAgICAgICByZXR1cm4gYCR7aG91cnMgPiAwID8gYCR7aG91cnMudG9TdHJpbmcoKS5wYWRTdGFydCgyLCBcIjBcIil9OmAgOiBcIlwifSR7TWF0aC5mbG9vcigocyAvIDYwKSAlIDYwKS50b1N0cmluZygpLnBhZFN0YXJ0KDIsIFwiMFwiKX06JHsocyAlIDYwKS50b1N0cmluZygpLnBhZFN0YXJ0KDIsIFwiMFwiKX1gO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICB9LFxyXG4gICAgICAgICAgbW91bnRlZCgpIHtcclxuICAgICAgICAgICAgaW50ZXJuYWxBcHAgPSB0aGlzO1xyXG4gICAgICAgICAgICB0aGlzLmZldGNoRGF0YSgpO1xyXG4gICAgICAgICAgICBGbHV4RGlzcGF0Y2hlci5zdWJzY3JpYmUoXCJTUE9USUZZX1BMQVlFUl9TVEFURVwiLCB0aGlzLnN0YXRlVXBkYXRlKVxyXG4gICAgICAgICAgICB0aGlzLnVwZGF0ZUludGVydmFsKCk7XHJcbiAgICAgICAgICB9LFxyXG4gICAgICAgICAgdW5tb3VudGVkKCkge1xyXG4gICAgICAgICAgICBjbGVhckludGVydmFsKHRoaXMuY2hlY2tJbnRlcnZhbCk7XHJcbiAgICAgICAgICAgIEZsdXhEaXNwYXRjaGVyLnVuc3Vic2NyaWJlKFwiU1BPVElGWV9QTEFZRVJfU1RBVEVcIiwgdGhpcy5zdGF0ZVVwZGF0ZSlcclxuICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgYXBwLm1vdW50KGFwcEVsbSk7XHJcbiAgICAgICAgZG9jdW1lbnQucXVlcnlTZWxlY3Rvcignc2VjdGlvbi5wYW5lbHMtM3dGdE1EID4gLndyYXBwZXItM0hrOU9CJykuaW5zZXJ0QWRqYWNlbnRFbGVtZW50KFwiYWZ0ZXJlbmRcIiwgYXBwRWxtKTtcclxuICAgICAgICByZXR1cm4gKCkgPT4ge1xyXG4gICAgICAgICAgYXBwLnVubW91bnQoKTtcclxuICAgICAgICAgIGFwcEVsbS5yZW1vdmUoKTtcclxuICAgICAgICB9XHJcbiAgICAgIH0pKClcclxuICAgIClcclxuICB9XHJcbn0iXSwibmFtZXMiOlsic3Vic2NyaXB0aW9ucyIsImRvbSIsInV0aWxzIiwiRmx1eERpc3BhdGNoZXIiXSwibWFwcGluZ3MiOiJvaUdBS0EsWUFBZTtBQUNmLEVBQUUsSUFBSSxHQUFHO0FBQ1QsSUFBSUEsdUJBQWEsQ0FBQyxJQUFJO0FBQ3RCLE1B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
