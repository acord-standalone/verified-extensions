(function(p,n,d,u,f,g){"use strict";function o(t){return t&&typeof t=="object"&&"default"in t?t:{default:t}}var v=o(d),r=o(u),i=o(f),h=()=>g.injectCSS(".sc--container>.player{border-bottom:1px solid var(--background-modifier-accent);padding:8px;display:flex;flex-direction:column;gap:8px}.sc--container>.player .big-artwork{width:224px;height:224px;background-position:center;background-size:cover;border-radius:4px;display:flex;align-items:flex-start;justify-content:flex-end}.sc--container>.player .big-artwork:hover .collapse{opacity:.25}.sc--container>.player .big-artwork .collapse{display:flex;padding:4px;background-color:#000;opacity:0;border-radius:50%;margin:4px;cursor:pointer}.sc--container>.player .big-artwork .collapse:hover{opacity:.75}.sc--container>.player .big-artwork .collapse svg{width:16px;height:16px;color:#f5f5f5}.sc--container>.player .small-artwork{width:64px;height:64px;min-width:64px;background-position:center;background-size:cover;border-radius:4px;display:flex;align-items:flex-start;justify-content:flex-end}.sc--container>.player .small-artwork:hover .expand{opacity:.25}.sc--container>.player .small-artwork .expand{display:flex;padding:4px;background-color:#000;opacity:0;border-radius:50%;margin:4px;cursor:pointer}.sc--container>.player .small-artwork .expand:hover{opacity:.75}.sc--container>.player .small-artwork .expand svg{width:14px;height:14px;color:#f5f5f5}.sc--container>.player>.info{display:flex;gap:8px;justify-content:center}.sc--container>.player>.info>.data{width:100%;display:flex;justify-content:center;flex-direction:column;gap:8px}.sc--container>.player>.info>.data>.texts .title{font-size:16px;color:#f5f5f5;font-weight:500;opacity:.95;width:152px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.sc--container>.player>.info>.data>.texts .artist{font-size:12px;color:#f5f5f5;font-weight:400;opacity:.75;width:152px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.sc--container>.player>.info>.data>.texts .expand{width:224px}.sc--container>.player>.info>.data>.controls{display:flex;justify-content:space-around}.sc--container>.player>.info>.data>.controls .button{display:flex;background-color:#0000001a;padding:4px;border-radius:4px;cursor:pointer}.sc--container>.player>.info>.data>.controls .button svg{width:16px;height:16px;color:#f5f5f5}.sc--container>.player>.info>.data>.controls .button:hover{background-color:#00000040}.sc--container>.player>.progress-container{display:flex;align-items:center;gap:8px}.sc--container>.player>.progress-container .text{font-size:12px;color:#f5f5f5;min-width:32px}.sc--container>.player>.progress-container>.progress{width:100%;overflow:hidden;height:12px;-webkit-appearance:none;background-color:#00000026;border-radius:9999px;cursor:pointer}.sc--container>.player>.progress-container>.progress::-webkit-slider-thumb{width:12px;height:12px;-webkit-appearance:none;background:whitesmoke;border-radius:50%;cursor:ew-resize}"),x={load(){p.subscriptions.push(h(),(()=>{const t=v.default.parse(`
            <div class="sc--container">
              <div v-if="track" class="player">
                <div v-if="track?.album?.image && bigArtwork" class="big-artwork" :style="\`background-image: url('\${track.album.image.url}')\`">
                  <div class="collapse" @click="bigArtwork = false">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                      <path fill="currentColor" d="M11.9997 13.1714L16.9495 8.22168L18.3637 9.63589L11.9997 15.9999L5.63574 9.63589L7.04996 8.22168L11.9997 13.1714Z"></path>
                    </svg>
                  </div>
                </div>
                <div class="info">
                  <div v-if="track?.album?.image && !bigArtwork" class="small-artwork" :style="\`background-image: url('\${track.album.image.url}')\`">
                    <div class="expand" @click="bigArtwork = true">
                      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                        <path fill="currentColor" d="M11.9997 10.8284L7.04996 15.7782L5.63574 14.364L11.9997 8L18.3637 14.364L16.9495 15.7782L11.9997 10.8284Z"></path>
                      </svg>
                    </div>
                  </div>
                  <div class="data">
                    <div class="texts">
                      <div class="title" :class="{'expand': bigArtwork}" :acord--tooltip-content="track.name">{{ track.name }}</div>
                      <div class="artist" :class="{'expand': bigArtwork}" :acord--tooltip-content="track.artists[0].name">{{ track.artists[0].name }}</div>
                    </div>
                    <div class="controls">
                      <div class="button" @click="skipPrevious">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                          <path fill="currentColor" d="M8 12L14 6V18L8 12Z"></path>
                        </svg>
                      </div>
                      <div class="button" @click="playPause">
                        <svg v-if="!isPlaying" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                          <path fill="currentColor" d="M19.376 12.4158L8.77735 19.4816C8.54759 19.6348 8.23715 19.5727 8.08397 19.3429C8.02922 19.2608 8 19.1643 8 19.0656V4.93408C8 4.65794 8.22386 4.43408 8.5 4.43408C8.59871 4.43408 8.69522 4.4633 8.77735 4.51806L19.376 11.5838C19.6057 11.737 19.6678 12.0474 19.5146 12.2772C19.478 12.3321 19.4309 12.3792 19.376 12.4158Z"></path>
                        </svg>
                        <svg v-else xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                          <path fill="currentColor" d="M6 5H8V19H6V5ZM16 5H18V19H16V5Z"></path>
                        </svg>
                      </div>
                      <div class="button" @click="skipNext">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                          <path fill="currentColor" d="M16 12L10 18V6L16 12Z"></path>
                        </svg>
                      </div>
                    </div>
                  </div>
                </div>
                <div class="progress-container">
                  <div class="text">{{formatSeconds(progress/1000)}}</div>
                  <input type="range" class="progress" :value="progress" :max="duration" @input="onProgressInput" />
                  <div class="text">{{formatSeconds(duration/1000)}}</div>
                </div>
              </div>
            </div>
          `);let s=null;const l=Vue.createApp({data(){return{bigArtwork:!1,track:null,checkInterval:null,isPlaying:!1,progress:0,duration:0}},methods:{async fetchData(){let e=await r.default.spotify.request("GET","/me/player");e.item.album.image=e.item.album.images[0],this.track=e.item,this.isPlaying=e.is_playing,this.progress=e.progress_ms,this.duration=e.item.duration_ms,this.updateInterval()},stateUpdate(e){this.track=e.track,this.isPlaying=e.isPlaying,this.progress=e.position,this.duration=e.track?.duration||0,this.updateInterval()},playPause(){this.isPlaying?(r.default.spotify.request("PUT","/me/player/pause"),this.isPlaying=!1):(r.default.spotify.request("PUT","/me/player/play"),this.isPlaying=!0)},skipNext(){r.default.spotify.request("POST","/me/player/next")},skipPrevious(){this.progress>6e3?r.default.spotify.request("PUT","/me/player/seek?position_ms=0"):r.default.spotify.request("POST","/me/player/previous")},onProgressInput(e){clearInterval(s.checkInterval),this.debouncedProgressUpdate(e)},debouncedProgressUpdate:_.debounce(e=>{r.default.spotify.request("PUT","/me/player/seek?position_ms="+e.target.value),s.updateInterval()},250),updateInterval(){clearInterval(this.checkInterval),this.checkInterval=setInterval(()=>{this.isPlaying&&(this.progress+=1e3)},1e3)},formatSeconds(e){isNaN(parseInt(e))&&(e=0),e=Math.floor(e);let c=Math.floor(e/60/60);return`${c>0?`${c.toString().padStart(2,"0")}:`:""}${Math.floor(e/60%60).toString().padStart(2,"0")}:${(e%60).toString().padStart(2,"0")}`}},mounted(){s=this,this.fetchData(),n.FluxDispatcher.subscribe("SPOTIFY_PLAYER_STATE",this.stateUpdate),this.updateInterval()},unmounted(){clearInterval(this.checkInterval),n.FluxDispatcher.unsubscribe("SPOTIFY_PLAYER_STATE",this.stateUpdate)}});l.mount(t);function a(){t.remove(),document.querySelector(".sc--container")||document.querySelector("section.panels-3wFtMD > .wrapper-3Hk9OB").insertAdjacentElement("afterend",t)}return i.default.on("MainWindowFullScreenExit",a),i.default.on("CurrentUserChange",a),i.default.on("LocaleChange",a),a(),()=>{l.unmount(),t.remove(),i.default.off("MainWindowFullScreenExit",a),i.default.off("CurrentUserChange",a),i.default.off("LocaleChange",a)}})())}};return x})($acord.extension,$acord.modules.common,$acord.dom,$acord.utils,$acord.events,$acord.patcher);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic291cmNlLmpzIiwic291cmNlcyI6WyIuLi9zcmMvaW5kZXguanMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgc3Vic2NyaXB0aW9ucyB9IGZyb20gXCJAYWNvcmQvZXh0ZW5zaW9uXCI7XHJcbmltcG9ydCB7IEZsdXhEaXNwYXRjaGVyIH0gZnJvbSBcIkBhY29yZC9tb2R1bGVzL2NvbW1vblwiO1xyXG5pbXBvcnQgZG9tIGZyb20gXCJAYWNvcmQvZG9tXCI7XHJcbmltcG9ydCB1dGlscyBmcm9tIFwiQGFjb3JkL3V0aWxzXCI7XHJcbmltcG9ydCBldmVudHMgZnJvbSBcIkBhY29yZC9ldmVudHNcIjtcclxuaW1wb3J0IHBhdGNoU0NTUyBmcm9tIFwiLi9zdHlsZXMuc2Nzc1wiO1xyXG5cclxuZXhwb3J0IGRlZmF1bHQge1xyXG4gIGxvYWQoKSB7XHJcbiAgICBzdWJzY3JpcHRpb25zLnB1c2goXHJcbiAgICAgIHBhdGNoU0NTUygpLFxyXG4gICAgICAoKCkgPT4ge1xyXG4gICAgICAgIGNvbnN0IGFwcEVsbSA9IGRvbS5wYXJzZShcclxuICAgICAgICAgIGBcclxuICAgICAgICAgICAgPGRpdiBjbGFzcz1cInNjLS1jb250YWluZXJcIj5cclxuICAgICAgICAgICAgICA8ZGl2IHYtaWY9XCJ0cmFja1wiIGNsYXNzPVwicGxheWVyXCI+XHJcbiAgICAgICAgICAgICAgICA8ZGl2IHYtaWY9XCJ0cmFjaz8uYWxidW0/LmltYWdlICYmIGJpZ0FydHdvcmtcIiBjbGFzcz1cImJpZy1hcnR3b3JrXCIgOnN0eWxlPVwiXFxgYmFja2dyb3VuZC1pbWFnZTogdXJsKCdcXCR7dHJhY2suYWxidW0uaW1hZ2UudXJsfScpXFxgXCI+XHJcbiAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJjb2xsYXBzZVwiIEBjbGljaz1cImJpZ0FydHdvcmsgPSBmYWxzZVwiPlxyXG4gICAgICAgICAgICAgICAgICAgIDxzdmcgeG1sbnM9XCJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2Z1wiIHZpZXdCb3g9XCIwIDAgMjQgMjRcIj5cclxuICAgICAgICAgICAgICAgICAgICAgIDxwYXRoIGZpbGw9XCJjdXJyZW50Q29sb3JcIiBkPVwiTTExLjk5OTcgMTMuMTcxNEwxNi45NDk1IDguMjIxNjhMMTguMzYzNyA5LjYzNTg5TDExLjk5OTcgMTUuOTk5OUw1LjYzNTc0IDkuNjM1ODlMNy4wNDk5NiA4LjIyMTY4TDExLjk5OTcgMTMuMTcxNFpcIj48L3BhdGg+XHJcbiAgICAgICAgICAgICAgICAgICAgPC9zdmc+XHJcbiAgICAgICAgICAgICAgICAgIDwvZGl2PlxyXG4gICAgICAgICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPVwiaW5mb1wiPlxyXG4gICAgICAgICAgICAgICAgICA8ZGl2IHYtaWY9XCJ0cmFjaz8uYWxidW0/LmltYWdlICYmICFiaWdBcnR3b3JrXCIgY2xhc3M9XCJzbWFsbC1hcnR3b3JrXCIgOnN0eWxlPVwiXFxgYmFja2dyb3VuZC1pbWFnZTogdXJsKCdcXCR7dHJhY2suYWxidW0uaW1hZ2UudXJsfScpXFxgXCI+XHJcbiAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz1cImV4cGFuZFwiIEBjbGljaz1cImJpZ0FydHdvcmsgPSB0cnVlXCI+XHJcbiAgICAgICAgICAgICAgICAgICAgICA8c3ZnIHhtbG5zPVwiaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmdcIiB2aWV3Qm94PVwiMCAwIDI0IDI0XCI+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIDxwYXRoIGZpbGw9XCJjdXJyZW50Q29sb3JcIiBkPVwiTTExLjk5OTcgMTAuODI4NEw3LjA0OTk2IDE1Ljc3ODJMNS42MzU3NCAxNC4zNjRMMTEuOTk5NyA4TDE4LjM2MzcgMTQuMzY0TDE2Ljk0OTUgMTUuNzc4MkwxMS45OTk3IDEwLjgyODRaXCI+PC9wYXRoPlxyXG4gICAgICAgICAgICAgICAgICAgICAgPC9zdmc+XHJcbiAgICAgICAgICAgICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgICAgICAgICAgIDwvZGl2PlxyXG4gICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPVwiZGF0YVwiPlxyXG4gICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJ0ZXh0c1wiPlxyXG4gICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz1cInRpdGxlXCIgOmNsYXNzPVwieydleHBhbmQnOiBiaWdBcnR3b3JrfVwiIDphY29yZC0tdG9vbHRpcC1jb250ZW50PVwidHJhY2submFtZVwiPnt7IHRyYWNrLm5hbWUgfX08L2Rpdj5cclxuICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJhcnRpc3RcIiA6Y2xhc3M9XCJ7J2V4cGFuZCc6IGJpZ0FydHdvcmt9XCIgOmFjb3JkLS10b29sdGlwLWNvbnRlbnQ9XCJ0cmFjay5hcnRpc3RzWzBdLm5hbWVcIj57eyB0cmFjay5hcnRpc3RzWzBdLm5hbWUgfX08L2Rpdj5cclxuICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cclxuICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPVwiY29udHJvbHNcIj5cclxuICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJidXR0b25cIiBAY2xpY2s9XCJza2lwUHJldmlvdXNcIj5cclxuICAgICAgICAgICAgICAgICAgICAgICAgPHN2ZyB4bWxucz1cImh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnXCIgdmlld0JveD1cIjAgMCAyNCAyNFwiPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgIDxwYXRoIGZpbGw9XCJjdXJyZW50Q29sb3JcIiBkPVwiTTggMTJMMTQgNlYxOEw4IDEyWlwiPjwvcGF0aD5cclxuICAgICAgICAgICAgICAgICAgICAgICAgPC9zdmc+XHJcbiAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cclxuICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJidXR0b25cIiBAY2xpY2s9XCJwbGF5UGF1c2VcIj5cclxuICAgICAgICAgICAgICAgICAgICAgICAgPHN2ZyB2LWlmPVwiIWlzUGxheWluZ1wiIHhtbG5zPVwiaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmdcIiB2aWV3Qm94PVwiMCAwIDI0IDI0XCI+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgPHBhdGggZmlsbD1cImN1cnJlbnRDb2xvclwiIGQ9XCJNMTkuMzc2IDEyLjQxNThMOC43NzczNSAxOS40ODE2QzguNTQ3NTkgMTkuNjM0OCA4LjIzNzE1IDE5LjU3MjcgOC4wODM5NyAxOS4zNDI5QzguMDI5MjIgMTkuMjYwOCA4IDE5LjE2NDMgOCAxOS4wNjU2VjQuOTM0MDhDOCA0LjY1Nzk0IDguMjIzODYgNC40MzQwOCA4LjUgNC40MzQwOEM4LjU5ODcxIDQuNDM0MDggOC42OTUyMiA0LjQ2MzMgOC43NzczNSA0LjUxODA2TDE5LjM3NiAxMS41ODM4QzE5LjYwNTcgMTEuNzM3IDE5LjY2NzggMTIuMDQ3NCAxOS41MTQ2IDEyLjI3NzJDMTkuNDc4IDEyLjMzMjEgMTkuNDMwOSAxMi4zNzkyIDE5LjM3NiAxMi40MTU4WlwiPjwvcGF0aD5cclxuICAgICAgICAgICAgICAgICAgICAgICAgPC9zdmc+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIDxzdmcgdi1lbHNlIHhtbG5zPVwiaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmdcIiB2aWV3Qm94PVwiMCAwIDI0IDI0XCI+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgPHBhdGggZmlsbD1cImN1cnJlbnRDb2xvclwiIGQ9XCJNNiA1SDhWMTlINlY1Wk0xNiA1SDE4VjE5SDE2VjVaXCI+PC9wYXRoPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICA8L3N2Zz5cclxuICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PlxyXG4gICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz1cImJ1dHRvblwiIEBjbGljaz1cInNraXBOZXh0XCI+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIDxzdmcgeG1sbnM9XCJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2Z1wiIHZpZXdCb3g9XCIwIDAgMjQgMjRcIj5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICA8cGF0aCBmaWxsPVwiY3VycmVudENvbG9yXCIgZD1cIk0xNiAxMkwxMCAxOFY2TDE2IDEyWlwiPjwvcGF0aD5cclxuICAgICAgICAgICAgICAgICAgICAgICAgPC9zdmc+XHJcbiAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cclxuICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cclxuICAgICAgICAgICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgICAgICAgICA8L2Rpdj5cclxuICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJwcm9ncmVzcy1jb250YWluZXJcIj5cclxuICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz1cInRleHRcIj57e2Zvcm1hdFNlY29uZHMocHJvZ3Jlc3MvMTAwMCl9fTwvZGl2PlxyXG4gICAgICAgICAgICAgICAgICA8aW5wdXQgdHlwZT1cInJhbmdlXCIgY2xhc3M9XCJwcm9ncmVzc1wiIDp2YWx1ZT1cInByb2dyZXNzXCIgOm1heD1cImR1cmF0aW9uXCIgQGlucHV0PVwib25Qcm9ncmVzc0lucHV0XCIgLz5cclxuICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz1cInRleHRcIj57e2Zvcm1hdFNlY29uZHMoZHVyYXRpb24vMTAwMCl9fTwvZGl2PlxyXG4gICAgICAgICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgICAgIDwvZGl2PlxyXG4gICAgICAgICAgYCxcclxuICAgICAgICApXHJcblxyXG4gICAgICAgIGxldCBpbnRlcm5hbEFwcCA9IG51bGw7XHJcbiAgICAgICAgY29uc3QgYXBwID0gVnVlLmNyZWF0ZUFwcCh7XHJcbiAgICAgICAgICBkYXRhKCkge1xyXG4gICAgICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICAgIGJpZ0FydHdvcms6IGZhbHNlLFxyXG4gICAgICAgICAgICAgIHRyYWNrOiBudWxsLFxyXG4gICAgICAgICAgICAgIGNoZWNrSW50ZXJ2YWw6IG51bGwsXHJcbiAgICAgICAgICAgICAgaXNQbGF5aW5nOiBmYWxzZSxcclxuICAgICAgICAgICAgICBwcm9ncmVzczogMCxcclxuICAgICAgICAgICAgICBkdXJhdGlvbjogMFxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICB9LFxyXG4gICAgICAgICAgbWV0aG9kczoge1xyXG4gICAgICAgICAgICBhc3luYyBmZXRjaERhdGEoKSB7XHJcbiAgICAgICAgICAgICAgbGV0IGRhdGEgPSBhd2FpdCB1dGlscy5zcG90aWZ5LnJlcXVlc3QoXCJHRVRcIiwgXCIvbWUvcGxheWVyXCIpO1xyXG4gICAgICAgICAgICAgIGRhdGEuaXRlbS5hbGJ1bS5pbWFnZSA9IGRhdGEuaXRlbS5hbGJ1bS5pbWFnZXNbMF07XHJcblxyXG4gICAgICAgICAgICAgIHRoaXMudHJhY2sgPSBkYXRhLml0ZW07XHJcbiAgICAgICAgICAgICAgdGhpcy5pc1BsYXlpbmcgPSBkYXRhLmlzX3BsYXlpbmc7XHJcbiAgICAgICAgICAgICAgdGhpcy5wcm9ncmVzcyA9IGRhdGEucHJvZ3Jlc3NfbXM7XHJcbiAgICAgICAgICAgICAgdGhpcy5kdXJhdGlvbiA9IGRhdGEuaXRlbS5kdXJhdGlvbl9tcztcclxuXHJcbiAgICAgICAgICAgICAgdGhpcy51cGRhdGVJbnRlcnZhbCgpO1xyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICBzdGF0ZVVwZGF0ZShkYXRhKSB7XHJcbiAgICAgICAgICAgICAgdGhpcy50cmFjayA9IGRhdGEudHJhY2s7XHJcbiAgICAgICAgICAgICAgdGhpcy5pc1BsYXlpbmcgPSBkYXRhLmlzUGxheWluZztcclxuICAgICAgICAgICAgICB0aGlzLnByb2dyZXNzID0gZGF0YS5wb3NpdGlvbjtcclxuICAgICAgICAgICAgICB0aGlzLmR1cmF0aW9uID0gZGF0YS50cmFjaz8uZHVyYXRpb24gfHwgMDtcclxuICAgICAgICAgICAgICB0aGlzLnVwZGF0ZUludGVydmFsKCk7XHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIHBsYXlQYXVzZSgpIHtcclxuICAgICAgICAgICAgICBpZiAodGhpcy5pc1BsYXlpbmcpIHtcclxuICAgICAgICAgICAgICAgIHV0aWxzLnNwb3RpZnkucmVxdWVzdChcIlBVVFwiLCBcIi9tZS9wbGF5ZXIvcGF1c2VcIik7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmlzUGxheWluZyA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICB1dGlscy5zcG90aWZ5LnJlcXVlc3QoXCJQVVRcIiwgXCIvbWUvcGxheWVyL3BsYXlcIik7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmlzUGxheWluZyA9IHRydWU7XHJcbiAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICBza2lwTmV4dCgpIHtcclxuICAgICAgICAgICAgICB1dGlscy5zcG90aWZ5LnJlcXVlc3QoXCJQT1NUXCIsIFwiL21lL3BsYXllci9uZXh0XCIpO1xyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICBza2lwUHJldmlvdXMoKSB7XHJcbiAgICAgICAgICAgICAgaWYgKHRoaXMucHJvZ3Jlc3MgPiA2MDAwKSB7XHJcbiAgICAgICAgICAgICAgICB1dGlscy5zcG90aWZ5LnJlcXVlc3QoXCJQVVRcIiwgXCIvbWUvcGxheWVyL3NlZWs/cG9zaXRpb25fbXM9MFwiKTtcclxuICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgdXRpbHMuc3BvdGlmeS5yZXF1ZXN0KFwiUE9TVFwiLCBcIi9tZS9wbGF5ZXIvcHJldmlvdXNcIik7XHJcbiAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICBvblByb2dyZXNzSW5wdXQoZSkge1xyXG4gICAgICAgICAgICAgIGNsZWFySW50ZXJ2YWwoaW50ZXJuYWxBcHAuY2hlY2tJbnRlcnZhbCk7XHJcbiAgICAgICAgICAgICAgdGhpcy5kZWJvdW5jZWRQcm9ncmVzc1VwZGF0ZShlKTtcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgZGVib3VuY2VkUHJvZ3Jlc3NVcGRhdGU6IF8uZGVib3VuY2UoKGUpID0+IHtcclxuICAgICAgICAgICAgICB1dGlscy5zcG90aWZ5LnJlcXVlc3QoXCJQVVRcIiwgXCIvbWUvcGxheWVyL3NlZWs/cG9zaXRpb25fbXM9XCIgKyBlLnRhcmdldC52YWx1ZSk7XHJcbiAgICAgICAgICAgICAgaW50ZXJuYWxBcHAudXBkYXRlSW50ZXJ2YWwoKTtcclxuICAgICAgICAgICAgfSwgMjUwKSxcclxuICAgICAgICAgICAgdXBkYXRlSW50ZXJ2YWwoKSB7XHJcbiAgICAgICAgICAgICAgY2xlYXJJbnRlcnZhbCh0aGlzLmNoZWNrSW50ZXJ2YWwpO1xyXG4gICAgICAgICAgICAgIHRoaXMuY2hlY2tJbnRlcnZhbCA9IHNldEludGVydmFsKCgpID0+IHtcclxuICAgICAgICAgICAgICAgIGlmICh0aGlzLmlzUGxheWluZykgdGhpcy5wcm9ncmVzcyArPSAxMDAwO1xyXG4gICAgICAgICAgICAgIH0sIDEwMDApO1xyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICBmb3JtYXRTZWNvbmRzKHMpIHtcclxuICAgICAgICAgICAgICBpZiAoaXNOYU4ocGFyc2VJbnQocykpKSBzID0gMDtcclxuICAgICAgICAgICAgICBzID0gTWF0aC5mbG9vcihzKTtcclxuICAgICAgICAgICAgICBsZXQgaG91cnMgPSBNYXRoLmZsb29yKChzIC8gNjApIC8gNjApO1xyXG4gICAgICAgICAgICAgIHJldHVybiBgJHtob3VycyA+IDAgPyBgJHtob3Vycy50b1N0cmluZygpLnBhZFN0YXJ0KDIsIFwiMFwiKX06YCA6IFwiXCJ9JHtNYXRoLmZsb29yKChzIC8gNjApICUgNjApLnRvU3RyaW5nKCkucGFkU3RhcnQoMiwgXCIwXCIpfTokeyhzICUgNjApLnRvU3RyaW5nKCkucGFkU3RhcnQoMiwgXCIwXCIpfWA7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgIH0sXHJcbiAgICAgICAgICBtb3VudGVkKCkge1xyXG4gICAgICAgICAgICBpbnRlcm5hbEFwcCA9IHRoaXM7XHJcbiAgICAgICAgICAgIHRoaXMuZmV0Y2hEYXRhKCk7XHJcbiAgICAgICAgICAgIEZsdXhEaXNwYXRjaGVyLnN1YnNjcmliZShcIlNQT1RJRllfUExBWUVSX1NUQVRFXCIsIHRoaXMuc3RhdGVVcGRhdGUpXHJcbiAgICAgICAgICAgIHRoaXMudXBkYXRlSW50ZXJ2YWwoKTtcclxuICAgICAgICAgIH0sXHJcbiAgICAgICAgICB1bm1vdW50ZWQoKSB7XHJcbiAgICAgICAgICAgIGNsZWFySW50ZXJ2YWwodGhpcy5jaGVja0ludGVydmFsKTtcclxuICAgICAgICAgICAgRmx1eERpc3BhdGNoZXIudW5zdWJzY3JpYmUoXCJTUE9USUZZX1BMQVlFUl9TVEFURVwiLCB0aGlzLnN0YXRlVXBkYXRlKVxyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBhcHAubW91bnQoYXBwRWxtKTtcclxuXHJcbiAgICAgICAgZnVuY3Rpb24gcmVJbmplY3QoKSB7XHJcbiAgICAgICAgICBhcHBFbG0ucmVtb3ZlKCk7XHJcbiAgICAgICAgICBpZiAoIWRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5zYy0tY29udGFpbmVyJykpXHJcbiAgICAgICAgICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJ3NlY3Rpb24ucGFuZWxzLTN3RnRNRCA+IC53cmFwcGVyLTNIazlPQicpXHJcbiAgICAgICAgICAgICAgLmluc2VydEFkamFjZW50RWxlbWVudChcImFmdGVyZW5kXCIsIGFwcEVsbSk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBldmVudHMub24oXCJNYWluV2luZG93RnVsbFNjcmVlbkV4aXRcIiwgcmVJbmplY3QpO1xyXG4gICAgICAgIGV2ZW50cy5vbihcIkN1cnJlbnRVc2VyQ2hhbmdlXCIsIHJlSW5qZWN0KTtcclxuICAgICAgICBldmVudHMub24oXCJMb2NhbGVDaGFuZ2VcIiwgcmVJbmplY3QpO1xyXG5cclxuICAgICAgICByZUluamVjdCgpO1xyXG5cclxuICAgICAgICByZXR1cm4gKCkgPT4ge1xyXG4gICAgICAgICAgYXBwLnVubW91bnQoKTtcclxuICAgICAgICAgIGFwcEVsbS5yZW1vdmUoKTtcclxuICAgICAgICAgIGV2ZW50cy5vZmYoXCJNYWluV2luZG93RnVsbFNjcmVlbkV4aXRcIiwgcmVJbmplY3QpO1xyXG4gICAgICAgICAgZXZlbnRzLm9mZihcIkN1cnJlbnRVc2VyQ2hhbmdlXCIsIHJlSW5qZWN0KTtcclxuICAgICAgICAgIGV2ZW50cy5vZmYoXCJMb2NhbGVDaGFuZ2VcIiwgcmVJbmplY3QpO1xyXG4gICAgICAgIH1cclxuICAgICAgfSkoKVxyXG4gICAgKVxyXG4gIH1cclxufSJdLCJuYW1lcyI6WyJzdWJzY3JpcHRpb25zIiwiZG9tIiwidXRpbHMiLCJGbHV4RGlzcGF0Y2hlciIsImV2ZW50cyJdLCJtYXBwaW5ncyI6IjBtR0FNQSxZQUFlO0FBQ2YsRUFBRSxJQUFJLEdBQUc7QUFDVCxJQUFJQSx1QkFBYSxDQUFDLElBQUk7QUFDdEIsTUFBTSxTQUFTLEVBQUU7QUFDakIsTUFBTSxDQUFDLE1BQU07QUFDYixRQUFRLE1BQU0sTUFBTSxHQUFHQyx1QkFBRyxDQUFDLEtBQUs7QUFDaEMsVUFBVSxDQUFDO0FBQ1g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFD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
