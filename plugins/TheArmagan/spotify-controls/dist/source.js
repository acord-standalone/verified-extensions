(function(p,n,d,u,f,g){"use strict";function o(t){return t&&typeof t=="object"&&"default"in t?t:{default:t}}var v=o(d),r=o(u),i=o(f),h=()=>g.injectCSS(".sc--container>.player{border-bottom:1px solid var(--background-modifier-accent);padding:8px;display:flex;flex-direction:column;gap:8px}.sc--container>.player .big-artwork{width:224px;height:224px;background-position:center;background-size:cover;border-radius:4px;display:flex;align-items:flex-start;justify-content:flex-end}.sc--container>.player .big-artwork:hover .collapse{opacity:.25}.sc--container>.player .big-artwork .collapse{display:flex;padding:4px;background-color:#000;opacity:0;border-radius:50%;margin:4px;cursor:pointer}.sc--container>.player .big-artwork .collapse:hover{opacity:.75}.sc--container>.player .big-artwork .collapse svg{width:16px;height:16px;color:#f5f5f5}.sc--container>.player .small-artwork{width:64px;height:64px;min-width:64px;background-position:center;background-size:cover;border-radius:4px;display:flex;align-items:flex-start;justify-content:flex-end}.sc--container>.player .small-artwork:hover .expand{opacity:.25}.sc--container>.player .small-artwork .expand{display:flex;padding:4px;background-color:#000;opacity:0;border-radius:50%;margin:4px;cursor:pointer}.sc--container>.player .small-artwork .expand:hover{opacity:.75}.sc--container>.player .small-artwork .expand svg{width:14px;height:14px;color:#f5f5f5}.sc--container>.player>.info{display:flex;gap:8px;justify-content:center}.sc--container>.player>.info>.data{width:100%;display:flex;justify-content:center;flex-direction:column;gap:8px}.sc--container>.player>.info>.data>.texts .title{font-size:16px;color:#f5f5f5;font-weight:500;opacity:.95;width:152px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.sc--container>.player>.info>.data>.texts .artist{font-size:12px;color:#f5f5f5;font-weight:400;opacity:.75;width:152px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.sc--container>.player>.info>.data>.texts .expand{width:224px}.sc--container>.player>.info>.data>.controls{display:flex;justify-content:space-around}.sc--container>.player>.info>.data>.controls .button{display:flex;background-color:#0000001a;padding:4px;border-radius:4px;cursor:pointer}.sc--container>.player>.info>.data>.controls .button svg{width:16px;height:16px;color:#f5f5f5}.sc--container>.player>.info>.data>.controls .button:hover{background-color:#00000040}.sc--container>.player>.progress-container{display:flex;align-items:center;gap:8px}.sc--container>.player>.progress-container .text{font-size:12px;color:#f5f5f5;min-width:32px}.sc--container>.player>.progress-container>.progress{width:100%;overflow:hidden;height:12px;-webkit-appearance:none;background-color:#00000026;border-radius:9999px;cursor:pointer}.sc--container>.player>.progress-container>.progress::-webkit-slider-thumb{width:12px;height:12px;-webkit-appearance:none;background:whitesmoke;border-radius:50%;cursor:ew-resize}"),x={load(){p.subscriptions.push(h(),(()=>{const t=v.default.parse(`
            <div class="sc--container">
              <div v-if="track" class="player">
                <div v-if="track?.album?.image && bigArtwork" class="big-artwork" :style="\`background-image: url('\${track.album.image.url}')\`">
                  <div class="collapse" @click="bigArtwork = false">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                      <path fill="currentColor" d="M11.9997 13.1714L16.9495 8.22168L18.3637 9.63589L11.9997 15.9999L5.63574 9.63589L7.04996 8.22168L11.9997 13.1714Z"></path>
                    </svg>
                  </div>
                </div>
                <div class="info">
                  <div v-if="track?.album?.image && !bigArtwork" class="small-artwork" :style="\`background-image: url('\${track.album.image.url}')\`">
                    <div class="expand" @click="bigArtwork = true">
                      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                        <path fill="currentColor" d="M11.9997 10.8284L7.04996 15.7782L5.63574 14.364L11.9997 8L18.3637 14.364L16.9495 15.7782L11.9997 10.8284Z"></path>
                      </svg>
                    </div>
                  </div>
                  <div class="data">
                    <div class="texts">
                      <div class="title" :class="{'expand': bigArtwork}" :acord--tooltip-content="track.name">{{ track.name }}</div>
                      <div class="artist" :class="{'expand': bigArtwork}" :acord--tooltip-content="track.artists[0].name">{{ track.artists[0].name }}</div>
                    </div>
                    <div class="controls">
                      <div class="button" @click="skipPrevious">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                          <path fill="currentColor" d="M8 12L14 6V18L8 12Z"></path>
                        </svg>
                      </div>
                      <div class="button" @click="playPause">
                        <svg v-if="!isPlaying" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                          <path fill="currentColor" d="M19.376 12.4158L8.77735 19.4816C8.54759 19.6348 8.23715 19.5727 8.08397 19.3429C8.02922 19.2608 8 19.1643 8 19.0656V4.93408C8 4.65794 8.22386 4.43408 8.5 4.43408C8.59871 4.43408 8.69522 4.4633 8.77735 4.51806L19.376 11.5838C19.6057 11.737 19.6678 12.0474 19.5146 12.2772C19.478 12.3321 19.4309 12.3792 19.376 12.4158Z"></path>
                        </svg>
                        <svg v-else xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                          <path fill="currentColor" d="M6 5H8V19H6V5ZM16 5H18V19H16V5Z"></path>
                        </svg>
                      </div>
                      <div class="button" @click="skipNext">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                          <path fill="currentColor" d="M16 12L10 18V6L16 12Z"></path>
                        </svg>
                      </div>
                    </div>
                  </div>
                </div>
                <div class="progress-container">
                  <div class="text">{{formatSeconds(progress/1000)}}</div>
                  <input type="range" class="progress" :value="progress" :max="duration" @input="onProgressInput" />
                  <div class="text">{{formatSeconds(duration/1000)}}</div>
                </div>
              </div>
            </div>
          `);let s=null;const l=Vue.createApp({data(){return{bigArtwork:!1,track:null,checkInterval:null,isPlaying:!1,progress:0,duration:0}},methods:{async fetchData(){let e=await r.default.spotify.request("GET","/me/player");e.item.album.image=e.item.album.images[0],this.track=e.item,this.isPlaying=e.is_playing,this.progress=e.progress_ms,this.duration=e.item.duration_ms,this.updateInterval()},stateUpdate(e){this.track=e.track,this.isPlaying=e.isPlaying,this.progress=e.position,this.duration=e.track?.duration||0,this.updateInterval()},playPause(){this.isPlaying?(r.default.spotify.request("PUT","/me/player/pause#"),this.isPlaying=!1):(r.default.spotify.request("PUT","/me/player/play"),this.isPlaying=!0)},skipNext(){r.default.spotify.request("POST","/me/player/next")},skipPrevious(){this.progress>6e3?r.default.spotify.request("PUT","/me/player/seek?position_ms=0"):r.default.spotify.request("POST","/me/player/previous")},onProgressInput(e){clearInterval(s.checkInterval),this.debouncedProgressUpdate(e)},debouncedProgressUpdate:_.debounce(e=>{r.default.spotify.request("PUT","/me/player/seek?position_ms="+e.target.value),s.updateInterval()},250),updateInterval(){clearInterval(this.checkInterval),this.checkInterval=setInterval(()=>{this.isPlaying&&(this.progress+=1e3)},1e3)},formatSeconds(e){isNaN(parseInt(e))&&(e=0),e=Math.floor(e);let c=Math.floor(e/60/60);return`${c>0?`${c.toString().padStart(2,"0")}:`:""}${Math.floor(e/60%60).toString().padStart(2,"0")}:${(e%60).toString().padStart(2,"0")}`}},mounted(){s=this,this.fetchData(),n.FluxDispatcher.subscribe("SPOTIFY_PLAYER_STATE",this.stateUpdate),this.updateInterval()},unmounted(){clearInterval(this.checkInterval),n.FluxDispatcher.unsubscribe("SPOTIFY_PLAYER_STATE",this.stateUpdate)}});l.mount(t);function a(){t.remove(),document.querySelector(".sc--container")||document.querySelector("section.panels-3wFtMD > .wrapper-VSquwh").insertAdjacentElement("afterend",t)}return i.default.on("MainWindowFullScreenExit",a),i.default.on("CurrentUserChange",a),i.default.on("LocaleChange",a),a(),()=>{l.unmount(),t.remove(),i.default.off("MainWindowFullScreenExit",a),i.default.off("CurrentUserChange",a),i.default.off("LocaleChange",a)}})())}};return x})($acord.extension,$acord.modules.common,$acord.dom,$acord.utils,$acord.events,$acord.patcher);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic291cmNlLmpzIiwic291cmNlcyI6WyIuLi9zcmMvaW5kZXguanMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgc3Vic2NyaXB0aW9ucyB9IGZyb20gXCJAYWNvcmQvZXh0ZW5zaW9uXCI7XHJcbmltcG9ydCB7IEZsdXhEaXNwYXRjaGVyIH0gZnJvbSBcIkBhY29yZC9tb2R1bGVzL2NvbW1vblwiO1xyXG5pbXBvcnQgZG9tIGZyb20gXCJAYWNvcmQvZG9tXCI7XHJcbmltcG9ydCB1dGlscyBmcm9tIFwiQGFjb3JkL3V0aWxzXCI7XHJcbmltcG9ydCBldmVudHMgZnJvbSBcIkBhY29yZC9ldmVudHNcIjtcclxuaW1wb3J0IHBhdGNoU0NTUyBmcm9tIFwiLi9zdHlsZXMuc2Nzc1wiO1xyXG5cclxuZXhwb3J0IGRlZmF1bHQge1xyXG4gIGxvYWQoKSB7XHJcbiAgICBzdWJzY3JpcHRpb25zLnB1c2goXHJcbiAgICAgIHBhdGNoU0NTUygpLFxyXG4gICAgICAoKCkgPT4ge1xyXG4gICAgICAgIGNvbnN0IGFwcEVsbSA9IGRvbS5wYXJzZShcclxuICAgICAgICAgIGBcclxuICAgICAgICAgICAgPGRpdiBjbGFzcz1cInNjLS1jb250YWluZXJcIj5cclxuICAgICAgICAgICAgICA8ZGl2IHYtaWY9XCJ0cmFja1wiIGNsYXNzPVwicGxheWVyXCI+XHJcbiAgICAgICAgICAgICAgICA8ZGl2IHYtaWY9XCJ0cmFjaz8uYWxidW0/LmltYWdlICYmIGJpZ0FydHdvcmtcIiBjbGFzcz1cImJpZy1hcnR3b3JrXCIgOnN0eWxlPVwiXFxgYmFja2dyb3VuZC1pbWFnZTogdXJsKCdcXCR7dHJhY2suYWxidW0uaW1hZ2UudXJsfScpXFxgXCI+XHJcbiAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJjb2xsYXBzZVwiIEBjbGljaz1cImJpZ0FydHdvcmsgPSBmYWxzZVwiPlxyXG4gICAgICAgICAgICAgICAgICAgIDxzdmcgeG1sbnM9XCJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2Z1wiIHZpZXdCb3g9XCIwIDAgMjQgMjRcIj5cclxuICAgICAgICAgICAgICAgICAgICAgIDxwYXRoIGZpbGw9XCJjdXJyZW50Q29sb3JcIiBkPVwiTTExLjk5OTcgMTMuMTcxNEwxNi45NDk1IDguMjIxNjhMMTguMzYzNyA5LjYzNTg5TDExLjk5OTcgMTUuOTk5OUw1LjYzNTc0IDkuNjM1ODlMNy4wNDk5NiA4LjIyMTY4TDExLjk5OTcgMTMuMTcxNFpcIj48L3BhdGg+XHJcbiAgICAgICAgICAgICAgICAgICAgPC9zdmc+XHJcbiAgICAgICAgICAgICAgICAgIDwvZGl2PlxyXG4gICAgICAgICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPVwiaW5mb1wiPlxyXG4gICAgICAgICAgICAgICAgICA8ZGl2IHYtaWY9XCJ0cmFjaz8uYWxidW0/LmltYWdlICYmICFiaWdBcnR3b3JrXCIgY2xhc3M9XCJzbWFsbC1hcnR3b3JrXCIgOnN0eWxlPVwiXFxgYmFja2dyb3VuZC1pbWFnZTogdXJsKCdcXCR7dHJhY2suYWxidW0uaW1hZ2UudXJsfScpXFxgXCI+XHJcbiAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz1cImV4cGFuZFwiIEBjbGljaz1cImJpZ0FydHdvcmsgPSB0cnVlXCI+XHJcbiAgICAgICAgICAgICAgICAgICAgICA8c3ZnIHhtbG5zPVwiaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmdcIiB2aWV3Qm94PVwiMCAwIDI0IDI0XCI+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIDxwYXRoIGZpbGw9XCJjdXJyZW50Q29sb3JcIiBkPVwiTTExLjk5OTcgMTAuODI4NEw3LjA0OTk2IDE1Ljc3ODJMNS42MzU3NCAxNC4zNjRMMTEuOTk5NyA4TDE4LjM2MzcgMTQuMzY0TDE2Ljk0OTUgMTUuNzc4MkwxMS45OTk3IDEwLjgyODRaXCI+PC9wYXRoPlxyXG4gICAgICAgICAgICAgICAgICAgICAgPC9zdmc+XHJcbiAgICAgICAgICAgICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgICAgICAgICAgIDwvZGl2PlxyXG4gICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPVwiZGF0YVwiPlxyXG4gICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJ0ZXh0c1wiPlxyXG4gICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz1cInRpdGxlXCIgOmNsYXNzPVwieydleHBhbmQnOiBiaWdBcnR3b3JrfVwiIDphY29yZC0tdG9vbHRpcC1jb250ZW50PVwidHJhY2submFtZVwiPnt7IHRyYWNrLm5hbWUgfX08L2Rpdj5cclxuICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJhcnRpc3RcIiA6Y2xhc3M9XCJ7J2V4cGFuZCc6IGJpZ0FydHdvcmt9XCIgOmFjb3JkLS10b29sdGlwLWNvbnRlbnQ9XCJ0cmFjay5hcnRpc3RzWzBdLm5hbWVcIj57eyB0cmFjay5hcnRpc3RzWzBdLm5hbWUgfX08L2Rpdj5cclxuICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cclxuICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPVwiY29udHJvbHNcIj5cclxuICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJidXR0b25cIiBAY2xpY2s9XCJza2lwUHJldmlvdXNcIj5cclxuICAgICAgICAgICAgICAgICAgICAgICAgPHN2ZyB4bWxucz1cImh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnXCIgdmlld0JveD1cIjAgMCAyNCAyNFwiPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgIDxwYXRoIGZpbGw9XCJjdXJyZW50Q29sb3JcIiBkPVwiTTggMTJMMTQgNlYxOEw4IDEyWlwiPjwvcGF0aD5cclxuICAgICAgICAgICAgICAgICAgICAgICAgPC9zdmc+XHJcbiAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cclxuICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJidXR0b25cIiBAY2xpY2s9XCJwbGF5UGF1c2VcIj5cclxuICAgICAgICAgICAgICAgICAgICAgICAgPHN2ZyB2LWlmPVwiIWlzUGxheWluZ1wiIHhtbG5zPVwiaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmdcIiB2aWV3Qm94PVwiMCAwIDI0IDI0XCI+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgPHBhdGggZmlsbD1cImN1cnJlbnRDb2xvclwiIGQ9XCJNMTkuMzc2IDEyLjQxNThMOC43NzczNSAxOS40ODE2QzguNTQ3NTkgMTkuNjM0OCA4LjIzNzE1IDE5LjU3MjcgOC4wODM5NyAxOS4zNDI5QzguMDI5MjIgMTkuMjYwOCA4IDE5LjE2NDMgOCAxOS4wNjU2VjQuOTM0MDhDOCA0LjY1Nzk0IDguMjIzODYgNC40MzQwOCA4LjUgNC40MzQwOEM4LjU5ODcxIDQuNDM0MDggOC42OTUyMiA0LjQ2MzMgOC43NzczNSA0LjUxODA2TDE5LjM3NiAxMS41ODM4QzE5LjYwNTcgMTEuNzM3IDE5LjY2NzggMTIuMDQ3NCAxOS41MTQ2IDEyLjI3NzJDMTkuNDc4IDEyLjMzMjEgMTkuNDMwOSAxMi4zNzkyIDE5LjM3NiAxMi40MTU4WlwiPjwvcGF0aD5cclxuICAgICAgICAgICAgICAgICAgICAgICAgPC9zdmc+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIDxzdmcgdi1lbHNlIHhtbG5zPVwiaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmdcIiB2aWV3Qm94PVwiMCAwIDI0IDI0XCI+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgPHBhdGggZmlsbD1cImN1cnJlbnRDb2xvclwiIGQ9XCJNNiA1SDhWMTlINlY1Wk0xNiA1SDE4VjE5SDE2VjVaXCI+PC9wYXRoPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICA8L3N2Zz5cclxuICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PlxyXG4gICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz1cImJ1dHRvblwiIEBjbGljaz1cInNraXBOZXh0XCI+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIDxzdmcgeG1sbnM9XCJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2Z1wiIHZpZXdCb3g9XCIwIDAgMjQgMjRcIj5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICA8cGF0aCBmaWxsPVwiY3VycmVudENvbG9yXCIgZD1cIk0xNiAxMkwxMCAxOFY2TDE2IDEyWlwiPjwvcGF0aD5cclxuICAgICAgICAgICAgICAgICAgICAgICAgPC9zdmc+XHJcbiAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cclxuICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cclxuICAgICAgICAgICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgICAgICAgICA8L2Rpdj5cclxuICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJwcm9ncmVzcy1jb250YWluZXJcIj5cclxuICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz1cInRleHRcIj57e2Zvcm1hdFNlY29uZHMocHJvZ3Jlc3MvMTAwMCl9fTwvZGl2PlxyXG4gICAgICAgICAgICAgICAgICA8aW5wdXQgdHlwZT1cInJhbmdlXCIgY2xhc3M9XCJwcm9ncmVzc1wiIDp2YWx1ZT1cInByb2dyZXNzXCIgOm1heD1cImR1cmF0aW9uXCIgQGlucHV0PVwib25Qcm9ncmVzc0lucHV0XCIgLz5cclxuICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz1cInRleHRcIj57e2Zvcm1hdFNlY29uZHMoZHVyYXRpb24vMTAwMCl9fTwvZGl2PlxyXG4gICAgICAgICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgICAgIDwvZGl2PlxyXG4gICAgICAgICAgYCxcclxuICAgICAgICApXHJcblxyXG4gICAgICAgIGxldCBpbnRlcm5hbEFwcCA9IG51bGw7XHJcbiAgICAgICAgY29uc3QgYXBwID0gVnVlLmNyZWF0ZUFwcCh7XHJcbiAgICAgICAgICBkYXRhKCkge1xyXG4gICAgICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICAgIGJpZ0FydHdvcms6IGZhbHNlLFxyXG4gICAgICAgICAgICAgIHRyYWNrOiBudWxsLFxyXG4gICAgICAgICAgICAgIGNoZWNrSW50ZXJ2YWw6IG51bGwsXHJcbiAgICAgICAgICAgICAgaXNQbGF5aW5nOiBmYWxzZSxcclxuICAgICAgICAgICAgICBwcm9ncmVzczogMCxcclxuICAgICAgICAgICAgICBkdXJhdGlvbjogMFxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICB9LFxyXG4gICAgICAgICAgbWV0aG9kczoge1xyXG4gICAgICAgICAgICBhc3luYyBmZXRjaERhdGEoKSB7XHJcbiAgICAgICAgICAgICAgbGV0IGRhdGEgPSBhd2FpdCB1dGlscy5zcG90aWZ5LnJlcXVlc3QoXCJHRVRcIiwgXCIvbWUvcGxheWVyXCIpO1xyXG4gICAgICAgICAgICAgIGRhdGEuaXRlbS5hbGJ1bS5pbWFnZSA9IGRhdGEuaXRlbS5hbGJ1bS5pbWFnZXNbMF07XHJcblxyXG4gICAgICAgICAgICAgIHRoaXMudHJhY2sgPSBkYXRhLml0ZW07XHJcbiAgICAgICAgICAgICAgdGhpcy5pc1BsYXlpbmcgPSBkYXRhLmlzX3BsYXlpbmc7XHJcbiAgICAgICAgICAgICAgdGhpcy5wcm9ncmVzcyA9IGRhdGEucHJvZ3Jlc3NfbXM7XHJcbiAgICAgICAgICAgICAgdGhpcy5kdXJhdGlvbiA9IGRhdGEuaXRlbS5kdXJhdGlvbl9tcztcclxuXHJcbiAgICAgICAgICAgICAgdGhpcy51cGRhdGVJbnRlcnZhbCgpO1xyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICBzdGF0ZVVwZGF0ZShkYXRhKSB7XHJcbiAgICAgICAgICAgICAgdGhpcy50cmFjayA9IGRhdGEudHJhY2s7XHJcbiAgICAgICAgICAgICAgdGhpcy5pc1BsYXlpbmcgPSBkYXRhLmlzUGxheWluZztcclxuICAgICAgICAgICAgICB0aGlzLnByb2dyZXNzID0gZGF0YS5wb3NpdGlvbjtcclxuICAgICAgICAgICAgICB0aGlzLmR1cmF0aW9uID0gZGF0YS50cmFjaz8uZHVyYXRpb24gfHwgMDtcclxuICAgICAgICAgICAgICB0aGlzLnVwZGF0ZUludGVydmFsKCk7XHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIHBsYXlQYXVzZSgpIHtcclxuICAgICAgICAgICAgICBpZiAodGhpcy5pc1BsYXlpbmcpIHtcclxuICAgICAgICAgICAgICAgIHV0aWxzLnNwb3RpZnkucmVxdWVzdChcIlBVVFwiLCBcIi9tZS9wbGF5ZXIvcGF1c2UjXCIpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5pc1BsYXlpbmcgPSBmYWxzZTtcclxuICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgdXRpbHMuc3BvdGlmeS5yZXF1ZXN0KFwiUFVUXCIsIFwiL21lL3BsYXllci9wbGF5XCIpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5pc1BsYXlpbmcgPSB0cnVlO1xyXG4gICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgc2tpcE5leHQoKSB7XHJcbiAgICAgICAgICAgICAgdXRpbHMuc3BvdGlmeS5yZXF1ZXN0KFwiUE9TVFwiLCBcIi9tZS9wbGF5ZXIvbmV4dFwiKTtcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgc2tpcFByZXZpb3VzKCkge1xyXG4gICAgICAgICAgICAgIGlmICh0aGlzLnByb2dyZXNzID4gNjAwMCkge1xyXG4gICAgICAgICAgICAgICAgdXRpbHMuc3BvdGlmeS5yZXF1ZXN0KFwiUFVUXCIsIFwiL21lL3BsYXllci9zZWVrP3Bvc2l0aW9uX21zPTBcIik7XHJcbiAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIHV0aWxzLnNwb3RpZnkucmVxdWVzdChcIlBPU1RcIiwgXCIvbWUvcGxheWVyL3ByZXZpb3VzXCIpO1xyXG4gICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgb25Qcm9ncmVzc0lucHV0KGUpIHtcclxuICAgICAgICAgICAgICBjbGVhckludGVydmFsKGludGVybmFsQXBwLmNoZWNrSW50ZXJ2YWwpO1xyXG4gICAgICAgICAgICAgIHRoaXMuZGVib3VuY2VkUHJvZ3Jlc3NVcGRhdGUoZSk7XHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIGRlYm91bmNlZFByb2dyZXNzVXBkYXRlOiBfLmRlYm91bmNlKChlKSA9PiB7XHJcbiAgICAgICAgICAgICAgdXRpbHMuc3BvdGlmeS5yZXF1ZXN0KFwiUFVUXCIsIFwiL21lL3BsYXllci9zZWVrP3Bvc2l0aW9uX21zPVwiICsgZS50YXJnZXQudmFsdWUpO1xyXG4gICAgICAgICAgICAgIGludGVybmFsQXBwLnVwZGF0ZUludGVydmFsKCk7XHJcbiAgICAgICAgICAgIH0sIDI1MCksXHJcbiAgICAgICAgICAgIHVwZGF0ZUludGVydmFsKCkge1xyXG4gICAgICAgICAgICAgIGNsZWFySW50ZXJ2YWwodGhpcy5jaGVja0ludGVydmFsKTtcclxuICAgICAgICAgICAgICB0aGlzLmNoZWNrSW50ZXJ2YWwgPSBzZXRJbnRlcnZhbCgoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5pc1BsYXlpbmcpIHRoaXMucHJvZ3Jlc3MgKz0gMTAwMDtcclxuICAgICAgICAgICAgICB9LCAxMDAwKTtcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgZm9ybWF0U2Vjb25kcyhzKSB7XHJcbiAgICAgICAgICAgICAgaWYgKGlzTmFOKHBhcnNlSW50KHMpKSkgcyA9IDA7XHJcbiAgICAgICAgICAgICAgcyA9IE1hdGguZmxvb3Iocyk7XHJcbiAgICAgICAgICAgICAgbGV0IGhvdXJzID0gTWF0aC5mbG9vcigocyAvIDYwKSAvIDYwKTtcclxuICAgICAgICAgICAgICByZXR1cm4gYCR7aG91cnMgPiAwID8gYCR7aG91cnMudG9TdHJpbmcoKS5wYWRTdGFydCgyLCBcIjBcIil9OmAgOiBcIlwifSR7TWF0aC5mbG9vcigocyAvIDYwKSAlIDYwKS50b1N0cmluZygpLnBhZFN0YXJ0KDIsIFwiMFwiKX06JHsocyAlIDYwKS50b1N0cmluZygpLnBhZFN0YXJ0KDIsIFwiMFwiKX1gO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICB9LFxyXG4gICAgICAgICAgbW91bnRlZCgpIHtcclxuICAgICAgICAgICAgaW50ZXJuYWxBcHAgPSB0aGlzO1xyXG4gICAgICAgICAgICB0aGlzLmZldGNoRGF0YSgpO1xyXG4gICAgICAgICAgICBGbHV4RGlzcGF0Y2hlci5zdWJzY3JpYmUoXCJTUE9USUZZX1BMQVlFUl9TVEFURVwiLCB0aGlzLnN0YXRlVXBkYXRlKVxyXG4gICAgICAgICAgICB0aGlzLnVwZGF0ZUludGVydmFsKCk7XHJcbiAgICAgICAgICB9LFxyXG4gICAgICAgICAgdW5tb3VudGVkKCkge1xyXG4gICAgICAgICAgICBjbGVhckludGVydmFsKHRoaXMuY2hlY2tJbnRlcnZhbCk7XHJcbiAgICAgICAgICAgIEZsdXhEaXNwYXRjaGVyLnVuc3Vic2NyaWJlKFwiU1BPVElGWV9QTEFZRVJfU1RBVEVcIiwgdGhpcy5zdGF0ZVVwZGF0ZSlcclxuICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgYXBwLm1vdW50KGFwcEVsbSk7XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIHJlSW5qZWN0KCkge1xyXG4gICAgICAgICAgYXBwRWxtLnJlbW92ZSgpO1xyXG4gICAgICAgICAgaWYgKCFkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuc2MtLWNvbnRhaW5lcicpKVxyXG4gICAgICAgICAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCdzZWN0aW9uLnBhbmVscy0zd0Z0TUQgPiAud3JhcHBlci1WU3F1d2gnKVxyXG4gICAgICAgICAgICAgIC5pbnNlcnRBZGphY2VudEVsZW1lbnQoXCJhZnRlcmVuZFwiLCBhcHBFbG0pO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZXZlbnRzLm9uKFwiTWFpbldpbmRvd0Z1bGxTY3JlZW5FeGl0XCIsIHJlSW5qZWN0KTtcclxuICAgICAgICBldmVudHMub24oXCJDdXJyZW50VXNlckNoYW5nZVwiLCByZUluamVjdCk7XHJcbiAgICAgICAgZXZlbnRzLm9uKFwiTG9jYWxlQ2hhbmdlXCIsIHJlSW5qZWN0KTtcclxuXHJcbiAgICAgICAgcmVJbmplY3QoKTtcclxuXHJcbiAgICAgICAgcmV0dXJuICgpID0+IHtcclxuICAgICAgICAgIGFwcC51bm1vdW50KCk7XHJcbiAgICAgICAgICBhcHBFbG0ucmVtb3ZlKCk7XHJcbiAgICAgICAgICBldmVudHMub2ZmKFwiTWFpbldpbmRvd0Z1bGxTY3JlZW5FeGl0XCIsIHJlSW5qZWN0KTtcclxuICAgICAgICAgIGV2ZW50cy5vZmYoXCJDdXJyZW50VXNlckNoYW5nZVwiLCByZUluamVjdCk7XHJcbiAgICAgICAgICBldmVudHMub2ZmKFwiTG9jYWxlQ2hhbmdlXCIsIHJlSW5qZWN0KTtcclxuICAgICAgICB9XHJcbiAgICAgIH0pKClcclxuICAgIClcclxuICB9XHJcbn0iXSwibmFtZXMiOlsic3Vic2NyaXB0aW9ucyIsImRvbSIsInV0aWxzIiwiRmx1eERpc3BhdGNoZXIiLCJldmVudHMiXSwibWFwcGluZ3MiOiIwbUdBTUEsWUFBZTtBQUNmLEVBQUUsSUFBSSxHQUFHO0FBQ1QsSUFBSUEsdUJBQWEsQ0FBQyxJQUFJO0FBQ3RCLE1BQU0sU0FBUyxFQUFFO0FBQ2pCLE1BQU0sQ0FBQyxNQUFNO0FBQ2IsUUFBUSxNQUFNLE1BQU0sR0FBR0MsdUJBQUcsQ0FBQyxLQUFLO0FBQ2hDLFVBQVUsQ0FBQztBQUNYO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FB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
